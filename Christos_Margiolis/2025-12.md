# December 2025 Status Update for Christos Margiolis

## **Reporting Period:** 2025-12-02 - 2025-12-08

### Project: Audio Stack Improvements

**Overall Status:** On Track

#### Completed Tasks

- Reviewed edited draft of my upcoming FBSDF article on audio.
- sndctl(8): Do not free and re-open device: https://cgit.freebsd.org/src/commit/?id=643a606fa2742b94f6eca620119b7d2686ca9cd3
- sound: Retire pcm_feeder->desc_static: https://reviews.freebsd.org/D54103

#### Ongoing Tasks

- snd_uaudio: Do not use pcm_channel->lock to protect uaudio_chan: https://reviews.freebsd.org/D54102
- sndctl(8): Add libxo support: https://reviews.freebsd.org/D54032
- sound: Stop building midi as a module: https://reviews.freebsd.org/D54125
- sound: Retire midi_devs and mstat_lock: https://reviews.freebsd.org/D54126
	- Also addresses [PR 261071](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=261071).
- snd_dummy: Initial MIDI support: https://reviews.freebsd.org/D54127
- sound: Retire snd_midi->qlock: https://reviews.freebsd.org/D54129
- sound: Unlock around uiomove() in midi_{read,write}(): https://reviews.freebsd.org/D54130
- sound: Improve snd_midi->{in,out}q allocation: https://reviews.freebsd.org/D54131
- sound: Do not free snd_midi->{in,out}q unconditionally in midi_uninit(): https://reviews.freebsd.org/D54135
- sound: Move sndstat out of pcm/: https://reviews.freebsd.org/D54140
- sound: Take device type into account in sndstat: https://reviews.freebsd.org/D54141
- [PR 291356](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=291356)
- [PR 291424](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=291424)
- Addressing several race conditions in sound(4), and trying to come up with a
  way to handle locking in a cleaner and more robust way.

#### Code Reviews

- sound/midi: Use only one lock to protect the data of a MIDI device: https://github.com/freebsd/freebsd-src/pull/1902
- sound/pci: Enable MIDI code in emu10kx: https://github.com/freebsd/freebsd-src/pull/1904
- sound/midi: Clarify MPU-401 init: https://github.com/freebsd/freebsd-src/pull/1905
- sound examples: Add mmap example: https://reviews.freebsd.org/D53749
- sound examples: Check if setting property was successful: https://reviews.freebsd.org/D54038
