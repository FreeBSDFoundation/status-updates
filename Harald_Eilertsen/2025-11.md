# November 2025 Status Update for Harald Eilertsen

[//]: <> (### Add weekly updates in reverse chronological order. ###)
## **Reporting Period:** 2025-11-19 - 2025-11-25

### Project: Improve OpenJDK on FreeBSD
#### **Overall Status:** On Track
#### **Summary**

- More work on OpenJDK memory alignment fix for non-heap allocations:
  - JBS: [JDK-8371637](https://bugs.openjdk.org/browse/JDK-8371637)
  - PR: [openjdk/jdk PR#28235](https://github.com/openjdk/jdk/pull/28235/commits/efbbfc3e30a2667adaa15ce26efc0376799ef1ae)
  - Waiting for the final review before integrating upstream
- Participated in reviews:
  - [D53782: Uses/java.mk - Add headless arg](https://reviews.freebsd.org/D53782)
  - [D53807: java/autofirma](https://reviews.freebsd.org/D53807)
  - [battleblow/jdk PR#25 - Fix FreeBSD Github Actions build](https://github.com/battleblow/jdk/pull/25)
  - [battleblow/jdk PR#27 - Cache OpenBSD packages to reduce networking](https://github.com/battleblow/jdk/pull/27)
  - [battleblow/jdk PR#28 - Limit name passed to pthread_set_name_np(3)](https://github.com/battleblow/jdk/pull/28)
  - [battleblow/jdk PR#29 - Restore -z,defs for *BSD](https://github.com/battleblow/jdk/pull/29)

#### **Completed Tasks**

- Synced battleblow repo with mainline:
  - PR: [battleblow/jdk PR#30](https://github.com/battleblow/jdk/pull/30)
- Add headless jre flavor to OpenJDK 25 port:
  - Review: [D53707](https://reviews.freebsd.org/D53707)
  - PR: [266059](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=266059)
  - Commit: [558ad9ce8991](https://cgit.freebsd.org/ports/commit/?id=558ad9ce89912a8c688d03c7e2560b55d49c5541)

#### **Features Delivered**

- Headless JRE build for java/openjdk25 port.

#### **Challenges**

None

#### **Blockers**

None

#### **Next Steps**

- Update OpenJDK 25 port to version 25.0.1
- Look into the two last failing tier1 tests for OpenJDK mainline
- Begin work upstream openjdk/bsd-port

#### **Open Questions and Discussion**

After [battleblow/jdk PR#29](https://github.com/battleblow/jdk/pull/29) building with GCC will probably not work. To be fair, I haven't tested building with GCC in a long while anyways, so it may already be broken. Unless there are any good reasons to build with GCC instead of clang, I don't see that it has a lot of value to keep supporting it. Clang is suppoerted by upstream, and is the preferred toolchain on FreeBSD, so as long as that works, I think we'll be fine. Just though it was worth mentioning.

## **Reporting Period:** 2025-11-12 - 2025-11-18

### Project: Improve OpenJDK on FreeBSD
#### **Overall Status:** On Track
#### **Summary**

This period has been mostly spent on improving the fix for [JBS-837137](https://bugs.openjdk.org/browse/JDK-8371637) - allocateNativeInternal sometimes return incorrectly aligned memory. Several iterations, and input from both BSD and OpenJDK people, have helped bring this patch to a state that we hopefully can integrate upstream soon. See [openjdk/jdk PR#28235](https://github.com/openjdk/jdk/pull/28235) for the details and discussion.

Also worked on adding a `jre_headless` variant to the `openjdk25` port. This is still ongoing. See [D53707](https://reviews.freebsd.org/D53707) / [Bug #266059](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=266059) for details.

First review of [D53782](https://reviews.freebsd.org/D53782), but will revisit in more detail later.

#### **Completed Tasks**

- Reviewed [battleblow/jdk PR#23](https://github.com/battleblow/jdk/pull/23#pullrequestreview-3458392859).
- Reviewed [battleblod/jdk PR#24](https://github.com/battleblow/jdk/pull/24).

#### **Features Delivered**

None this period

#### **Challenges**

None

#### **Blockers**

None

#### **Next Steps**

- Look into the two last failing tier1 tests for OpenJDK.
- Continue the work on headless jre.

#### **Open Questions and Discussion**


## **Reporting Period:** 2025-11-05 - 2025-11-11

### Project: Improve OpenJDK on FreeBSD
#### **Overall Status:** On Track
#### **Summary**

The upstream OpenJDK project has finally finished setting up our [`bsd-port`](https://github.com/openjdk/bsd-port) repository, so that we can start the work on upstreaming the port. We've had some good discussions among the BSD port team on how to proceed and organize the work. I also spent some time bringing in some minor upstream changes to the BSD port, and on figuring out the root cause of why the Memory Alignment test would intermittently fail on FreeBSD. A fix for this has been submitted for review directly upstream, as it's not directly related to the BSD port.

#### **Completed Tasks**

- Synced battleblow/jdk bsd-port branch with upstream mainline ([PR#20](https://github.com/battleblow/jdk/pull/20)).
- openjdk/bsd-port repo finally set up with a bsd-port branch for upstreaming patches.
  - Good discussions with both glewis and bsdkurt on structuring the work going forward.
- Thought I had found a fix for `TestMemoryAlignment` being flakey on FreeBSD, but found after some contemplation [that the fix was wrong](https://github.com/battleblow/jdk/pull/21#issuecomment-3510718913).
- Cleaning up some dead code and obsolete practices to bring the BSD port in line with mainline ([PR#22](https://github.com/battleblow/jdk/pull/22)).
- Finally figured out a solution for `TestMemoryAlignment` being flakey on FreeBSD:
  - JBS: https://bugs.openjdk.org/browse/JDK-8371637
  - PR: https://github.com/openjdk/jdk/pull/28235

#### **Features Delivered**

None this period.

#### **Challenges**

None.

#### **Blockers**

None.

#### **Next Steps**

- Check feasibility of creating a jre-headless flavor of the openjdk port ([Bug #266059](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=266059))
- Backport memory alignment fix to openjdk 24 and 25 ports.
- Sync the work from [battleblow/jdk](https://github.com/battleblow/jdk) to a new branch on the openjdk/bsd-port repo.

#### **Open Questions and Discussion**

- Should we make new openjdk versions available also in the quarterly branch of the ports tree?
  - Mailing list: https://lists.freebsd.org/archives/freebsd-java/2025-November/003365.html

## **Reporting Period:** 2025-10-29 - 2025-11-04

### Project: Improve OpenJDK on FreeBSD
#### **Overall Status:** On Track
#### **Summary**

Most of this past week was spent on adding `-jre` and `-headless` flavors to the java/openjdk25 port, as well as testing the flavors by running various Java apps. I've also spent some time on getting an Aarch64 VM up and running locally to enable me to build and test the aarch64 build of the JVM. This is still ongoing.

Also started looking into [Bug 290447](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=290447) about implementing `sun.nio.fs.AbstractWatchService` by using the `kqueue` API on FreeBSD. This should provide better performance than the current generic `PollingWatchService` used currently.

#### **Completed Tasks**

- Added flavors for building jre and headless variant to java/openjdk25 port:
  - Review: [D53450](https://reviews.freebsd.org/D53450)
  - Commit: [fe94eea5557](https://cgit.FreeBSD.org/ports/commit/?id=fe94eea55572b109ad291b3607ba59caff917a7e)
- Reviews for others:
  - battleblow/jdk25u: [PR#5: Backport mainline changes](https://github.com/battleblow/jdk25u/pull/5)

#### **Features Delivered**

- `-jre` and `-headless` flavors for java/openjdk25.

#### **Challenges**

- Testing on Aarch64 and PowerPC is lacking at the moment, but work is underway to remedy the situation.

#### **Blockers**

- Still missing push access to openjdk/bsd-port repo.

#### **Next Steps**

- Get up to date on changes in upstream mainline.
- Start looking at OpenJDK 26.

#### **Open Questions and Discussion**

[//]: <> (##########################################################)
