# January 2026 Status Update for Aymeric Wibo

[//]: <> (### Add weekly updates in reverse chronological order. ###)

## **Reporting Period:** 2026-01-28 - 2026-02-03

**Overall Status:** On Track

### Project: Laptop S0i3 Support

#### **Summary**

- Look into issue where the `_S255D` object is trying to be read on devices when entering s2idle - it is still unclear to me if we should be evaluating `_S3D` or `_S0D` in this case.
- Improve and commit [D48735 - acpi: Call SPMC suspend/resume hooks](https://reviews.freebsd.org/D48735).

#### **Next Steps**

- Re: Fix the issue where devices are put into `_S255`.
- Committing [D48721 - amdsmu: Sleep entry/exit hints for PMFW](https://reviews.freebsd.org/D48721).
- Do some more testing and try to get to the bottom of why APs are exiting C3 again when seemingly not being interrupted. Hopefully this will mean the changes to the scheduler as they currently stand are not needed.

## **Reporting Period:** 2026-01-21 - 2026-01-27

**Overall Status:** On Track

### Project: Laptop S0i3 Support

#### **Summary**

- Improvements to [D54407 - sched: Flag to force scheduler to always choose idle thread](https://reviews.freebsd.org/D54407).
- Many improvements to [D48387 - acpi_spmc: Add SPMC (system power management controller) driver](https://reviews.freebsd.org/D48387), including never using Microsoft DSM for getting constraints, adding 2 sysctls for debugging Intel and AMD DSM revision IDs (and defaulting them to 0 and 2 respectively), checking DSM function mask and warning of anything unexpected.
- Finally commit this (& fix subsequent build failure :P).
- Create new `acpi_pmc` device interface for late suspend and early resume for [D48735 - acpi: Call SPMC suspend/resume hooks](https://reviews.freebsd.org/D48735) and [D48721 - amdsmu: Sleep entry/exit hints for PMFW](https://reviews.freebsd.org/D48721).
- Replace `acpi_pmc` interface by new eventhandler hooks for those same revisions.
- Start reviewing [D54881 - intel/intel_pmc_core: Add Intel PMC Core driver](https://reviews.freebsd.org/D54881).
- Spend a while discussing s2idle looping and scheduler changes with olce@.

#### **Next Steps**

- Fix issue where the `_S255D` object is trying to be read on devices when entering s2idle.
- Committing [D48735 - acpi: Call SPMC suspend/resume hooks](https://reviews.freebsd.org/D48735).
- Committing [D48721 - amdsmu: Sleep entry/exit hints for PMFW](https://reviews.freebsd.org/D48721).
- Do some more testing and try to get to the bottom of why APs are exiting C3 again when seemingly not being interrupted. Hopefully this will mean the changes to the scheduler as they currently stand are not needed.

## **Reporting Period:** 2026-01-14 - 2026-01-20

**Overall Status:** On Track

### Project: Laptop S0i3 Support

#### **Summary**

- Commit s2idle revision ([D48734](https://reviews.freebsd.org/D48734)).
- More updates to SPMC revision ([D48387](https://reviews.freebsd.org/D48387), change DSM call order to match Windows & Linux, hold DSM set info in new `struct dsm_set`, print out DSM names and revisions when called, sysctl to change Intel DSM revision ID, plus a lot of other minor improvements).
- Look into [PR292568](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=292568) and commit fix ([D54777](https://reviews.freebsd.org/D54777)).
- Use `smp_rendezvous_cpus()` for telling AP schedulers to enter idle ([D54410](https://reviews.freebsd.org/D54410)) rather than using new idle/unidle IPIs ([D54409](https://reviews.freebsd.org/D54409)).
- Review [D54762 - acpi: Add Darwin OSI support for Apple Mac hardware](https://reviews.freebsd.org/D54762).
- Discuss concerns regarding [D54410 - acpi: Implement s2idle loop](https://reviews.freebsd.org/D54410).

#### **Next Steps**

- Commit acpi_spmc driver.
- New PMC interface for early resume and late suspend to replace bespoke callbacks for those SPMC operations in `struct acpi_softc`.

### Project: Graphics Stack Development

**Overall Status:** Again, some minor work to add some stuff wlroots wanted.

#### **Summary**

- Small fix for ioctls on DMA-BUFs ([freebsd/drm-kmod#404](https://github.com/freebsd/drm-kmod/pull/404)).
- Implement `DMA_BUF_IOCTL_IMPORT_SYNC_FILE` and `DMA_BUF_IOCTL_EXPORT_SYNC_FILE` ioctls on DMA-BUFs ([freebsd/drm-kmod#405](https://github.com/freebsd/drm-kmod/pull/405)).

## **Reporting Period:** 2025-01-07 - 2025-01-13

### Project: Laptop S0i3 Support

**Overall Status:** On Track

#### **Summary**

- Update and commit [D54406](https://reviews.freebsd.org/D54406) and work on `GET_BSP_CPUID()` on all archs.
- Review and test olce@'s ACPI patches ([D54624](https://reviews.freebsd.org/D54624), [D54625](https://reviews.freebsd.org/D54625), [D54626](https://reviews.freebsd.org/D54626), and [D54627](https://reviews.freebsd.org/D54627)).
- Updates and fixes to s2idle revision ([D48734](https://reviews.freebsd.org/D48734)).

#### **Next Steps**

- s2idle revision accepted; commit that.
- Fix SPMC comments.

## **Reporting Period:** 2025-12-31 - 2025-01-06

### Project: Graphics Stack Development

**Overall Status:** Just a small detour to fix an issue I was having with wlroots-based compositors :)

#### **Summary**

- Spend some time debugging issue where wlroots Vulkan renderer would consider DMA-BUF disjointed, causing it to fail when launching seemingly at random. This turned out to be related to inos not being set for DMA-BUF files in our DRM code.
- Create revision to always zero out stat struct before calling fo_stat: [D54556](https://reviews.freebsd.org/D54556) (probably gonna be dropped in favour of next item).
- PR to drm-kmod to do the same but in dma_buf_stat: [freebsd/drm-kmod#401](https://github.com/freebsd/drm-kmod/pull/401). This fixes the issue for now, but won't work for detecting DMA-BUFs that are actually disjointed.

#### **Next Steps**

- Figure out how Linux sets these inos so we can do the same.
