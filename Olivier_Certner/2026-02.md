# February 2026 Status Update for Olivier Certner

For the very beginning of February, see previous month's status report.

## **Reporting Period:** 2026-02-04 - 2026-02-10

### Dynamic P-state support (CPPC) \[Laptop Project\]
- Factor out `sysctl(9)` knobs and variables common to the Intel and AMD driver
  - Work on a different, simpler approach to ShengYi's
    [D54528](https://reviews.freebsd.org/D54528) ("hwpstate: Use dynamic sysctl
    initialization") where `sysctl(9)` knobs in conflict would be created
    dynamically on attach.
  - In the meantime, Abdelkader Boudih created review
    [D55139](https://reviews.freebsd.org/D55139) ("cpufreq: Fix sysctl name
    conflict between hwpstate_intel and hwpstate_amd") in the meantime, where
    the existing `machdep.hwpstate_pkg_ctrl` is in fact turned into two
    different knobs while giving up on the original name.  State that we do not
    want the old name to disappear for backwards compatibility and that I'm
    already handling the matter.
  - Take over [D54528](https://reviews.freebsd.org/D54528), re-title it to
    "hwpstate{_amd,intel}(4): Move common knobs to a separate file", ask for
    review and finally commit it, along with:
    - Commit
      [1a446f765d9cb34e](https://cgit.freebsd.org/src/commit/?id=1a446f765d9cb34e)
      ("sys/sysctl.h: Make it self-contained when included from the kernel"),
      a prerequisite.
    - Commit
      [bfd50a32ff260675](https://cgit.freebsd.org/src/commit/?id=bfd50a32ff260675)
      ("sys/sysctl.h: Add missing <sys/kassert.h> include") to fix
      `GENERIC-NODEBUG` compilation.
- Commit preliminary revisions:
  - [D54999](https://reviews.freebsd.org/D54999) ("hwpstate_amd(4): Factor out
    printing CPPC registers, fix CPPC_REQUEST's")
  - [D55000](https://reviews.freebsd.org/D55000) ("hwpstate_amd(4): Rename
    register dump sysctl handler")
  - [D55001](https://reviews.freebsd.org/D55001) ("hwpstate_amd(4): Assert
    PSTATE_CPPC is on in corresponding sysctl handlers")
  - [D55002](https://reviews.freebsd.org/D55002) ("hwpstate_amd(4): Rename EPP
    handler, convert to unsigned int")
  - [D55003](https://reviews.freebsd.org/D55003) ("hwpstate_amd(4): attach():
    Fix style")
  - [D55004](https://reviews.freebsd.org/D55004) ("hwpstate_amd(4): Revamp the
    softc")
- Answer `aokblast@`'s comments on reviews
  [D55007](https://reviews.freebsd.org/D55007) ("hwpstate_amd(4): Sane defaults
  for min/max perf on insane capabilities") and
  [D55008](https://reviews.freebsd.org/D55008) ("hwpstate_amd(4): Factor out
  setting the CPPC_REQUEST register"), and make small changes accordingly.
- Note that we are always updating the cached value of the `CPPC_REQUEST`
  register even if writing to it does not succeed.  Start reviewing such kind of
  problems and produce code to fix them.
- [PR 292615](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=292615)
  ("cpufreq changes causes AMD 4750U to run 11x slower"):
  - Following `cracauer@`'s proposal, ask for access to its AMD laptop.
  - Experience a panic caused by some change done in
    [D55005](https://reviews.freebsd.org/D55005) ("hwpstate_amd(4): Register
    dump: Fine-grained error reporting") that we did not see during the review
    so far.
  - Create a change to CPPC initialization to always request maximum
    performance (fixes `cracauer@`'s case).
  - Launch `cracauer@`'s benchmark (SBCL-based) with a variety of CPPC
    parameters (in progress).
- Review related [D55045](https://reviews.freebsd.org/D55045) ("x86: add a safe
  variant of MSR_OP_SCHED* operations") by `kib@`: Doubting this is the proper
  direction, we need more discussion on this.

### Power / Hibernate (S4) \[Laptop Project\]
- Commit
  [53bb02015fce72c7](https://cgit.freebsd.org/src/commit/?id=53bb02015fce72c7)
  ("amd64: parse_memmap(): Move comment about size at proper place").
- Commit revisions:
  - [D54925](https://reviews.freebsd.org/D54925) ("sysctl(9): Booleans: Accept
    integers to ease knob conversion")
  - [D54926](https://reviews.freebsd.org/D54926) ("acpi: Move sysctl tree set up
    at end of initialization")
  - [D54626](https://reviews.freebsd.org/D54626) ("acpi: 'hw.acpi.s4bios'
    sysctl: Change type to bool, expand description")
- Follow-ups to [D54925](https://reviews.freebsd.org/D54925) ("sysctl(9):
  Booleans: Accept integers to ease knob conversion") due to breakage:
  - [PR 292917](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=292917)
    ("machdep.hwpstate_amd_cppc_enable no longer works").
  - Commit [895e1c6567d9](https://cgit.freebsd.org/src/commit/?id=895e1c6567d9)
    ("sysctl(9): Booleans: Fix old value length discovery")
- Commit revision [D54627](https://reviews.freebsd.org/D54627) ("acpi: New R/O
  'hw.acpi.s4bios_supported' sysctl, gate S4BIOS with it"), and small side
  modifications:
  - Commit
    [584c4e0abbfdbac3](https://cgit.freebsd.org/src/commit/?id=584c4e0abbfdbac3)
    ("i386 minidump: Remove unused macros")
  - Commit
    [8bdcfc2a3febcd1a](https://cgit.freebsd.org/src/commit/?id=8bdcfc2a3febcd1a)
    ("endian.h: Visibility comment: Fix grammar, a typo and punctuation")
- Output the image with proper ELF headers
  - Review of dumping code (full dump, "minidump").
  - Review of dump device infrastructure (in particular GEOM code).
  - New `dumpsys_hibernate()` function, a hacked version of `dumpsys_generic()`
    for hibernate (WIP).
  - Discussion with `kib@` on:
    - The format of the segment listing pages to be used by the trampoline.
    - The memory needs (amount, contiguity) to restore the kernel image and jump
      to it.
  - More generally, re-do a pass on the hibernate HackMD document, checking that
    everything makes sense to me (a lot of the second part only vaguely did
    initially).

### Power / Suspend-to-idle (S0ix) \[Laptop Project\]
- Review [D55119](https://reviews.freebsd.org/D55119) ("acpi: Fix trying to
  enter NONE state"): Check for other potential similar mistakes, there are
  none; Approve.

### Laptop Project Admin
- Attend the Power weekly meeting.

### Scheduler
- Respond to some private mail about what "interactivity" means.
- Slight thinking about an alternate but more general design for the unfairness
  problem (problem 2).
- Slight context page-in for Linux's EEVDF.

### `srcmgr@` Lurker
- Review [D55150](https://reviews.freebsd.org/D55150) ("RELNOTES: Add some
  entries for recent commits"): Spot some typo, suggest a change, approve after
  the fixes.

### Review of Others' Work
- [D55082](https://reviews.freebsd.org/D55082) ("riscv: implement kernel ifunc
  resolution"): Answer some `imp@`'s question.
- [D55125](https://reviews.freebsd.org/D55125) ("diff: Report I/O errors in
  Stone algorithm"): Note that some change is gratuitous and makes things less
  readable.
- [D55146](https://reviews.freebsd.org/D55146) ("pwd: Clean up and adopt POSIX
  semantics"): A suspicious test with side-effects is in the end not a bug, but
  is unnecessarily obscure, so suggest changing it and approve the rest.
