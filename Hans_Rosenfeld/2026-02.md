# February 2026 Status Update for Hans Rosenfeld

[//]: <Week 8>
## **Reporting Period:** [2026-02-16] - [2026-02-22]

### Project: Full CPUID Control for bhyve
#### **Overall Status:** Delayed
#### **Summary**
Making progress on the implementation of the "sparse" CPUID configuration.
Implemented functions to fetch CPUID information from the "legacy" CPUID
emulation in the bhyve kernel code and to simplify assembling a complete
CPUID configuration set based on either "legacy" CPUID values or config
options.
#### **Open Questions and Discussion**
A lot of this code can be shared between bhyve and bhyvectl, but it doesn't
really belong into libvmmapi as it isn't really part of the VMM API.

Does anyone think it would wrong to create a libbhyve for such code? If not
I'll just do that.

[//]: <Week 7>
## **Reporting Period:** [2026-02-09] - [2026-02-15]

### Project: Full CPUID Control for bhyve
#### **Overall Status:** Delayed
#### **Summary**

Began work on the CPUID configuration and emulation code to allow for
"sparse" configurations. I intend to handle this in a way that preferably
needs little change to the kernel code as was provided by illumos:
- build a complete CPUID configuration that is identical to what the kernel
  would emulate for the host CPU
- make static per-VCPU adjustments
- override individual components of the CPUID data with using an extended
  configuration syntax that allows overriding of individual register values
  returned, either by overriding complete registers (`=`), or by
  masking/setting individual bits (`|=`, `&=`):

  `config.0x00000000,0x00=eax&=0x00003000,eax|=0x00001000,ecx=0x12345678`

  This would mask and then set bits in EAX, assign ECX, and leave the rest intact
  as reported by the hardware and modified by CPUID emulation in the kernel.

#### **Next Steps**
Finish and test the above.

The next step after that will introduce presets based on x86 architecture levels.

### Miscellaneous
#### **Summary**
Got called to help with a ZFS emergency on OmniOS by another customer, which
ate into my time for CPUID last week.

#### **Completed Tasks**
My VirtIO-SCSI work landed in illumos. :-)

Code review has resumed on the FreeBSD side. Thanks!

[//]: <Week 6>
## **Reporting Period:** [2026-02-02] - [2026-02-08]

### Project: Full CPUID Control for bhyve
#### **Overall Status:** Delayed
#### **Summary**
Not much happened last week as I was tied up with other tasks, such as getting
the VirtIO-SCSI work on illumos out the door.

#### **Next Steps**
Adapt the CPUID configuration and emulation code to allow for "sparse"
configurations.  This can be handled by extending the CPUID emulation to look
up CPUID values from the configuration, and only falling back to a native CPUID
instruction if none exists.

### Miscellaneous
#### **Summary**
I've finished the code review on the illumos side of things for the VirtIO-SCSI
project, things are ready for integration on their side.

Thanks Ed for committing the first bunch of changes for FreeBSD.

If anyone has interest in VirtIO-SCSI or spare cycles for review, there are a
few more (and bigger) changes that still need reviewing:

- https://reviews.freebsd.org/D53468
- https://reviews.freebsd.org/D53469
- https://reviews.freebsd.org/D53470

The following reviews will be updated shortly to match the latest state in illumos
and also still need review:

- https://reviews.freebsd.org/D53221
- https://reviews.freebsd.org/D53222
- https://reviews.freebsd.org/D53223
- https://reviews.freebsd.org/D54073

[//]: <> (##########################################################)
