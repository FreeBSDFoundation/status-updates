# January 2026 Status Update for Isaac Freund

[//]: <> (### Add weekly updates in reverse chronological order. ###)

## **Reporting Period:** 2026-01-20 - 2026-01-27

I'm currently feeling pretty sick and doing my best to recover before FOSDEM
this weekend. I also spent a fair amount of time preparing for my
[FOSDEM talk](https://fosdem.org/2026/schedule/event/GR8BFE-separating_the_wayland_compositor_and_window_manager/)
(not directly FreeBSD related this time...).

#### **Completed Tasks**

- Fixed a small bug in my changes to pkg last week: https://github.com/freebsd/pkg/pull/2595

#### **Work in progress**

The two patches from last week are waiting on review, I believe I've addressed all the comments:

- pkgbase: remove incorrect clang shlib requires [D54792](https://reviews.freebsd.org/D54792)
    - This solves the issue originally reported in https://github.com/freebsd/pkg/pull/2594
- pkgbase: only provide shlibs from /lib,/usr/lib,/usr/lib32 [D54793](https://reviews.freebsd.org/D54793)

I also spent some time researching the best path forward to support
Linux software depending on logind (GNOME, new KDE plasma login manager).

There are two diverging paths that can be taken:

1. Re-implement logind's dbus and library APIs
    - Does not require convincing upstream projects to accept patches
    - Parts of logind's API assume integration with the rest of systemd, elogind seems to get away with leaving such parts of logind's API unimplemented/stubbed out though.
    - The logind API is designed with Linux-specific features (e.g. cgroups) in mind. There appears to be a way to implement it using alternative features on FreeBSD currently, but this could change in the future.
    - This approach would mean playing catchup with upstream systemd-logind more-or-less forever.

2. Implement an alternative to logind which supports the features needed by e.g.
KDE and GNOME and work with upstreams to add support.
    - seatd proves that a useful subset of logind's API can be implemented by a
      single developer with much less code (<5kLOC for seatd vs nearly 200kLOC for
      elogind)
    - seatd does not provide all the features required by e.g. GNOME and KDE,
      TODO: figure out what logind features these projects actually use?

#### **Next Steps**

- Get back to `pkg install --register-only` in pkgbasify
- Take another look into https://github.com/freebsd/pkg/issues/2520, check for
  any other cases similar to the FreeBSD-clang situation that should be fixed by
  ignoring specific shared libraries.

## **Reporting Period:** 2026-01-13 - 2026-01-20

This week I finished up a good chunk of pkg work I had in progress and wrote two
patches to bring related pkgbase improvements to src.

#### **Completed Tasks**

- Improved handling of ignored shared libraries in pkg: https://github.com/freebsd/pkg/pull/2594
   - Unblocks solving https://github.com/freebsd/pkg/issues/2544 upstream in src
   - Included 3 bugfixes as well as the new features.

#### **Work in progress**

- pkgbase: remove incorrect clang shlib requires [D54792](https://reviews.freebsd.org/D54792)
    - This solves the issue originally reported in https://github.com/freebsd/pkg/pull/2594
- pkgbase: only provide shlibs from /lib,/usr/lib,/usr/lib32 [D54793](https://reviews.freebsd.org/D54793)

#### **Next Steps**

- Get back to `pkg install --register-only` in pkgbasify
- Take another look into https://github.com/freebsd/pkg/issues/2520, check for
  any other cases similar to the FreeBSD-clang situation that should be fixed by
  ignoring specific shared libraries.

## **Reporting Period:** 2026-01-06 - 2026-01-13

Traveled back to Germany this week and am still a bit jetlagged. I got less done
than I would have liked.

I spent my time working towards getting rid of the incorrect shlibs_required
entries in the FreeBSD-clang package for 15.0 (https://github.com/freebsd/pkg/issues/2544).

While pkg already allows ignoring specific required shlibs with the
`PKG_SHLIB_REQUIRE_IGNORE_GLOB` option, the structure of the build system in `src`
does not make it possible to pass package-specific arguments to pkg. Instead, it
expects all package-specific things to be specified in the package's manifest
(`release/packages/ucl/*.ucl`). I like handling things declaratively like this,
but this means I need to add a new pkg feature to fix FreeBSD-clang's shlibs_required.

#### **Work in progress**

- Started implementing support for specifying `shlibs_required_ignore` in package manifests
    - This made me realize that the current
    `PKG_SHLIB_{PROVIDE,REQUIRE}_IGNORE_{GLOB,REGEX}` options seem to interact poorly
    with pkg's `BACKUP_LIBRARIES` option, which the installer enables on pkgbase
    systems. Currently, pkg re-analyzes the ELF files of a library when it is
    backed up, but has no idea if provided/required shlibs were ignored when the
    package was created.
    - To fix this, I think we need to store ignored provided and required shlibs in the pkg database.

#### **Next Steps**

- Get back to `pkg install --register-only` in pkgbasify
- Take another look into https://github.com/freebsd/pkg/issues/2520, check for
  any other cases similar to the FreeBSD-clang situation that should be fixed by
  ignoring specific shared libraries.


## **Reporting Period:** 2026-01-01 - 2026-01-06

Got back to work after holidays this week and fixed several pkgbasify issues.

#### **Completed Tasks**

- [Use package sets on FreeBSD 15+](https://github.com/FreeBSDFoundation/pkgbasify/commit/e7b47f38d825f08ffa2bd17824c3171ab2267ac5)
- [Separately upgrade pkg before conversion](https://github.com/FreeBSDFoundation/pkgbasify/commit/c312cd5079cf9b576d4494f8a8155ab575c4da06)

#### **Work in progress**

- Use `pkg install --register-only` in pkgbasify
    - Implemented a proof of concept and successfully converted systems
    - The hard part is obtaining good UX:
        - Currently `pkg check` after installing pkgbase packages with `--register-only` fails when converting a fresh install. This should not happen, it should only fail if the user themselves modified files owned by pkg.
        - Must ensure that the system version matches the version of the packages to be installed exactly, otherwise many `pkg check` failures.
        - Reinstalling packages to fix failures can fail in practice:
    		- e.g. FreeBSD-clang-dev cannot be reinstalled due to schg flag on /libexec/ld-elf32.so.1 (especially problematic if the secure level has been raised)
    	- The jails I've been testing with don't contain all the tests installed by the FreeBSD-tests package, needs more investigation.
    - I currently plan to keep the old overwiting behavior around in pkgbasify as an option.

#### **Next Steps**

- Finish `pkg install --register-only` support in pkgbasify.
- Submit a fix for https://github.com/freebsd/pkg/issues/2544 upstream as I described in a comment (I of course hit this issue while testing pkgbasify).
- Get back into working on pkg issue https://github.com/freebsd/pkg/issues/2520
