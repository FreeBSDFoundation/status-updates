# January Status Update for Tom Jones

## **Reporting Period:** 2026-01-21 - 2025-01-27

### Project: Improve FreeBSD Power Usage 
#### **Overall Status:** On Track
#### **Summary**

FreeBSD runs on devices from high end servers through laptops and desktops down
to small embedded systems. On all systems it is a benefit if FreeBSD can use
the lowest practical amount of energy while still providing performance
responsive to user requests.

The foundation is look at various power management technologies in modern
devices with a focus on laptops.

This project aims to improve the introspectability of FreeBSD systems to better
understand which systems are contributing most to power usage. The initial
tasks in this activity look at creating tools and measurements to help design
the tools to investigate power usage. The ultimate goal of the project is to
meet the '8 hour working time' goal of the laptop project.

#### **Ongoing Tasks**
- [ ] Design a power profile and control board for usb-c devices
- [ ] upstream freebsd build host support for ch32fun
- [ ] extend perfetto with freebsd providers for:
    - [ ] sysctl
    - [ ] dtrace
    
    The perfetto system for supporting operating systems beyond linux isn't
    fully fledged and we are getting advice to do implementations different
    ways. As the second other platform we are bit behind the large outstanding
    pr to add qnx support.

    While we wait for clarity we will prototype these interfaces for getting
    data from freebsd into perfetto, but it is expected that rework will be
    required in the future.

#### **Completed Tasks**

- [x] Schematics for power control board
- [x] reviewed BayLibre power board design for hints
- [x] explored dtrace library interface for perfetto 

### Misc Items

- removed support for RFC2675 (Jumbograms)


## **Reporting Period:** 2026-01-09 - 2025-01-20

### Project: Improve FreeBSD Kernel Debugging
#### **Overall Status:** On Track
#### **Summary**

FreeBSD offers a variety of kernel debugging interfaces, the main interface
available on all systems is using the system console, typically via a graphics
interface. On modern system the graphics driver is routed via a GPU which
requires a lot of code to drive. This can lead to situations when the graphics
system crashes or the graphics output stops functioning where interactive
debugging is impossible or debugging at all isn't possible.

This project aims to provide a debugging mechanism that will work in the
absence of a functional graphics driver, first by updating and upstreaming xHCI
debug, by documenting and improving other debug interfaces and my adding
support for debugging interfaces in newer systems.

#### **Ongoing Tasks**
- [ ] Test loader support
- [ ] Test kernel support
- [ ] Track down stall in host mode driver

#### **Completed Tasks**

- [x] Design a second revision of the debug activator board
- [x] Design a usb-c xhci debug adapter board
- [x] panelize boards and submit for fabrication
- [x] Debug framework SOC uart issues
    The SOC uart issues were due to clock configuration. This has been resolved
    and we have a functional boot uart.

### Project: Improve FreeBSD Power Usage 
#### **Overall Status:** On Track
#### **Summary**

FreeBSD runs on devices from high end servers through laptops and desktops down
to small embedded systems. On all systems it is a benefit if FreeBSD can use
the lowest practical amount of energy while still providing performance
responsive to user requests.

The foundation is look at various power management technologies in modern
devices with a focus on laptops.

This project aims to improve the introspectability of FreeBSD systems to better
understand which systems are contributing most to power usage. The initial
tasks in this activity look at creating tools and measurements to help design
the tools to investigate power usage. The ultimate goal of the project is to
meet the '8 hour working time' goal of the laptop project.

#### **Ongoing Tasks**
- [ ] Design a power profile and control board for usb-c devices
- [ ] upstream freebsd build host support for ch32fun
- [ ] extend perfetto with freebsd providers for:
    - [ ] sysctl
    - [ ] dtrace
    
    The perfetto system for supporting operating systems beyond linux isn't
    fully fledged and we are getting advice to do implementations different
    ways. As the second other platform we are bit behind the large outstanding
    pr to add qnx support.

    While we wait for clarity we will prototype these interfaces for getting
    data from freebsd into perfetto, but it is expected that rework will be
    required in the future.

#### **Completed Tasks**

- [x] write a proof of concept perfetto provider for freebsd battery

## **Reporting Period:** 2026-01-08 - 2025-01-13 (Week 2)

### Project: Improve FreeBSD Kernel Debugging
#### **Overall Status:** On Track
#### **Summary**

FreeBSD offers a variety of kernel debugging interfaces, the main interface
available on all systems is using the system console, typically via a graphics
interface. On modern system the graphics driver is routed via a GPU which
requires a lot of code to drive. This can lead to situations when the graphics
system crashes or the graphics output stops functioning where interactive
debugging is impossible or debugging at all isn't possible.

This project aims to provide a debugging mechanism that will work in the
absence of a functional graphics driver, first by updating and upstreaming xHCI
debug, by documenting and improving other debug interfaces and my adding
support for debugging interfaces in newer systems.

#### **Ongoing Tasks**
- [ ] Test loader support
- [ ] Test kernel support
- [ ] Track down stall in host mode driver
    I think the issue is in FreeBSD xhci code and I will investigate this next.
    The packet capture interface we have is at a much higher level and can't
    expose xhci transactions.

- [ ] Debug framework SOC uart issues
    I have the SOC uart outputting bytes early in boot with several hacks. It
    seems the issue is the clock rate from firmware isn't populated in our path
    and so we take an invalid default value.

    On a vanilla kernel overridding this with the xo parameter in loader
    doesn't solve this issue so there is more needed to understand the correct
    fix, but a proof of concept works.
