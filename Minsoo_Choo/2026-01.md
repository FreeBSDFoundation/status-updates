# January 2026 Status Update for Minsoo Choo

[//]: <> (### Add weekly updates in reverse chronological order. ###)
## **Reporting Period:** 2026-01-14 - 2026-01-20

### Project: Review Instance Upgrade
#### **Overall Status:** On Track
#### **Summary**
With Li-wen and Ihor, I'm working on upgrading the review instance to latest FreeBSD release, packages, and Phabricator to Phorge.
The instructions are ready and Li-wen has arrived in the Kitchener office, so I expect the upgrade (or at least the test instance)
will open this week.
#### **Completed Tasks**
- Test on Ihor's AWS EC2 instance (been live for more than two weeks)
- Write instructions for clusteradm@
#### **Features Delivered**
#### **Challenges**
#### **Blockers**
#### **Next Steps**
- Create `reviews-dev.freebsd.org` and perform upgrade and verify functionality.
#### **Open Questions and Discussion**
- This will (hopefully) be our last update for Phabricator/Phorge as the focus will shift to Forgejo.

### Project: HMP Scheduling on FreeBSD
#### **Overall Status:** Delayed
#### **Summary**
Previuosly `cpucap`, but I renamed it to `hmp`. The [review](https://reviews.freebsd.org/D54674) is in progress and a report from the mailing list says
there hasn't been any issue so far after applying the patch.
#### **Completed Tasks**
- Write `hmp` framework
- Open a [review](https://reviews.freebsd.org/D54674)
#### **Features Delivered**
#### **Challenges**
- Turns out it is bit tricky to add HMP logics to ULE. Thus me (and olce@) will focus on fixing issues on ULE first.
#### **Blockers**
- The [review](https://reviews.freebsd.org/D54674) is waiting for approval.
- The [pcpu assertion PR](https://github.com/freebsd/freebsd-src/pull/1955) is approved but waiting for merge. I'll ping imp@.
#### **Next Steps**
 - Fix issues on ULE scheduler (see below)
 - Add sysctl for `cpucap` framework so users can check cpucap status and capability and score per core.
 - Add manpage for hmp(4)
 - Integrate cpucap into sched_ule.
 - Add providers such as Intel ITD, dt, Arm SCMI, ACPI CPPC.
#### **Open Questions and Discussion**

### Project: Fixing Issues with ULE Scheduler
#### **Overall Status:** Takeover by olce@
#### **Summary**
The ULE scheduler has two issues:
1. The nice value isn't respected well (trivial, olce@ suggested using exponential instead of linear impact on priority).
2. Under certain situation, the fairness balance for interactive tasks and CPU-bound tasks breaks.
#### **Completed Tasks**
#### **Features Delivered**
#### **Challenges**
#### **Blockers**
#### **Next Steps**
- Issue 1 can be solved easily. olce@ said he needs a month or two to start working on that, so I might start working on it
and ask olce@ to review my patch. The issue is this needs to be throughly tested but I don't have any test instance or
use case excpet for my PC. We might need to ask other contributors or companies for feedback.
- Issue 2 is more trickier. This needs full investigation on ULE code and planing the best solution. I will bring this topic
to AsiaBSDCon in March.
#### **Open Questions and Discussion**
- There is ongoing talk on deprecating 4BSD scheduler after fixing these issues. Contact olce@ for more info.

### Project: EEVDF Scheduler on FreeBSD
#### **Overall Status:** On Track
#### **Summary**
FreeBSD's two schedulers, 4BSD and ULE, are based on interactive scores. Since it is nearly impossible to have scheduler that
performs ideally in every environment, introducing fairness-based (ULE is still fair, but) scheduler for FreeBSD not only gives
wider range of options for users but also ensures that our kernel code isn't dependent on a single scheduler.
#### **Completed Tasks**
- EEVDF needs balanced binary tree. Linux uses red-black tree but FreeBSD's WAVL is fine. The issue is our WAVL implemetation lacks
min/max caching and some propagation/rotation augmentation callbacks. I opened a PR to address it but it failed because 1) caching
increases memory usage and some applications don't want it and 2) the current implementation of most data structures including WAVL
are written in C macros with some tricks (generate and prototype) which is painful and breaks to add new feature. Thus I started to
provide function-based API for the existing data structures. See [D54753](https://reviews.freebsd.org/D54753) for more info.
- It turned out `queue.3`'s name and synopsis are too long, so I created a patch to split it into four man pages. See
[D54770](https://reviews.freebsd.org/D54770) for more info.
#### **Features Delivered**
#### **Challenges**
#### **Blockers**
- [D54753](https://reviews.freebsd.org/D54753) and [D54770](https://reviews.freebsd.org/D54770) are waiting for review.
#### **Next Steps**
- Finish reading the EEVDF paper.
- See if schedulers as modules (see below) should preceed for easier implementation.
#### **Open Questions and Discussion**
- As noted above, should 4BSD deprecated after EEVDF? EEVDF is fairness-based which address ULE's current issue on fairness.

### Project: Schedulers as Modules
#### **Overall Status:** On Track
#### **Summary**
Currently FreeBSD schedulers are determined on build time. It would be nicer to have schedulers as modules so we can set it
on boot. This not only helps benchmarking different schedulers without building kernel but also opens door for out-of-tree
schedulers that third-parties can maintain.
#### **Completed Tasks**
#### **Features Delivered**
#### **Challenges**
#### **Blockers**
#### **Next Steps**
- Clean up scheduler interface (olce@ said some can be streamlined) so schedulers can share common interface.
- Separate 4BSD and ULE as modules.
- Document scheduler interface (e.g. how to create schedulers on FreeBSD?).
#### **Open Questions and Discussion**
- Is there any performance impact for running schedulers as modules?

### Miscellaneous
#### **Summary**
#### **Completed Tasks**
- Reviewed the new design of the FreeBSD website (no functional change, just the look) is being [reviewed](https://reviews.freebsd.org/D53910). 
carlavilla@ needs a few days to review.
- GenAI chapter for developer's guide is being [reviewed](https://reviews.freebsd.org/D54366), although I think GenAI usage
and its range should be discussed and approved by core@ and at devsummit.
#### **Features Delivered**
#### **Challenges**
#### **Blockers**
#### **Next Steps**
#### **Open Questions and Discussion**
[//]: <> (##########################################################)

## **Reporting Period:** 2026-01-05 - 2026-01-13

### Project: Review Instance Upgrade
#### **Overall Status:** On Track
#### **Summary**
Phabricator has been unmaintained for years and doens't play well with latest PHP versions.
#### **Completed Tasks**
 - Finished migration on test instance. Currently making a few final checks with Li-wen.
#### **Features Delivered**
 - Now uses latest software (including Phorge).
#### **Challenges**
#### **Blockers**
#### **Next Steps**
 - Reproduce upgrade path and notify clusteradm@ to do the actual upgrade on production.
#### **Open Questions and Discussion**
 - Ihor and I are considering migrating bugzilla bugs to Phorge's Maniphest, providing integrated DX without two separate instance for bug report and patch review. We are referencing MediaWiki's example (although they wrote the migration logic in Python 2), and considering working on migration scripts using golang.

### Project: Raspberry Pi 4 Wifi driver on FreeBSD
#### **Overall Status:** Delayed
#### **Summary**
Raspberry Pi 4 uses brcmfmac-sdio driver which hasn't been ported to FreeBSD yet. This port will utilize linuxkpi
#### **Completed Tasks**
 - Learned basics of device drivers on FreeBSD through "FreeBSD Device Drivers: A Guide for the Intrepid".
#### **Features Delivered**
#### **Challenges**
 - linuxkpi doesn't support yet, so we need to port linuxkpi for sdio first. (Actually none of mmc driver API hasn't been delivered)
#### **Blockers**
#### **Next Steps**
 - Through email, Bjoern said he'll get back to me this week, so I'm waiting for his response for now.
#### **Open Questions and Discussion**

### Project: HMP Scheduling on FreeBSD
#### **Overall Status:** On Track
#### **Summary**
Create a machine-independent HMP interface for scheduler (currently aims only for sched_ule, no 4bsd support)
#### **Completed Tasks**
 - Finished initial planning on HMP structure that plays well with existing scheduler with SMP support.
 - Finish and created patch on `cpucap` framework. (https://reviews.freebsd.org/D54674)
#### **Features Delivered**
#### **Challenges**
 - sched_ule is huge... First I need to go over `sched_ule.c` to see how code works (I know the concept, but never touched the code before)
#### **Blockers**
 - coredirector(4) patch series (https://reviews.freebsd.org/D44455) appeared two years ago but neglected. I emailed the author and he said he's willing to continue his work. This is basically ITD provider, but needs to be merged with the new `cpucap` framework
 - D54674 needs to be reviewed.
#### **Next Steps**
 - Add sysctl for `cpucap` framework so users can check cpucap status and capability and score per core.
 - Add manpage for hmp(4)
 - Integrate cpucap into sched_ule.
 - Add providers such as Intel ITD, dt, Arm SCMI, ACPI CPPC.
#### **Open Questions and Discussion**
 - If this is enabled by default on 16-RELEASE, we're being very lucky. In other words, there is a lot of work and verification to do.

### Miscellaneous
#### **Summary**
Miscellaneous bug fixes, changes, etc.

#### **Completed Tasks**
 - Many stale PRs and reviews have been merged.
 - Removed remaining PowerPC SPE code. I won't remove any further code from now on as srcmgr@ already seems to be working on it right now.
 - Added doxygen requirement checks and updated requirement note.
 - During cpucap work, I found out checks for pcpu structure size is too loose, which caused wrong padding size to make the pcpu size factor of page size. This fixed a bug where arm64's pcpu took twice more space than it should. PR approved by Warner, waiting for merge.

#### **Features Delivered**
#### **Challenges**
#### **Blockers**
 - pcpu fix is waiting for merge (https://github.com/freebsd/freebsd-src/pull/1955)
#### **Next Steps**
#### **Open Questions and Discussion**

[//]: <> (##########################################################)
