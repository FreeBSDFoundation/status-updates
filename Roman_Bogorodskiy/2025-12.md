# 12 2025 Status Update for Roman Bogorodskiy

## **Reporting Period:** [2025-12-15] - [2025-12-21]

### Project: libvirt on FreeBSD
#### **Overall Status:** On Track
#### **Summary**

Merged the SLIRP networking support for the libvirt driver.

Started working on the virtio-scsi support, have a working prototype,
but need to think how to properly model the CAM devices on libvirt level.

Started working on arm64 support. Again, have a working prototype and can
start VMs on arm64. However, it needs some work to do it properly, e.g.
prepare test infrastructure for arch-specific tests.

Another thing that shows up again is lack of proper capabilities reporting
in bhyve. New architecture adds a new dimension to that as presence
of a capability not only depends on bhyve version, but also the architecture.
I think I'll give up on my manpage capabilities parsing
[proof-of-concept](https://gitlab.com/rbogorodskiy/libvirt/-/tree/rbogorodskiy-bhyve-caps-manpage?)
as lack of the structured architecture support information adds
yet another point against this already fragile approach.
I plan to make another attempt on bringing up this topic on the
mailing list.

There are some issues observed on arm64, like
[not working CPU frequency reporting](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=291810),
but it doesn't seem to be critical for now, and does not
prevent from running VMs.

#### **Completed Tasks**

 * SLIRP networking support for the libvirt driver merged.

#### **Blockers**

Outline on the `bhyve` issues that are either blockers or create
a noticeable inconvenience for development:

 * [bootindex not working](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=279720),
 * [resume issues](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=290735),
 * [tpm issues](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=287326),
 * [virtio-input not working](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=290364),
 * Lack of capabilities reporting in bhyve.

#### **Next Steps**

 * Prepare and polish the existing arm64 patches for upstreaming,
 * Continue working on virtio-scsi, suspend/resume and other features,
 * Continue working on the [bhyve SLIRP DR](https://reviews.freebsd.org/D54133)
   and the [related issue](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=291616).

---

## **Reporting Period:** [2025-12-08] - [2025-12-14]

### Project: libvirt on FreeBSD
#### **Overall Status:** On Track
#### **Summary**

Merged
[bhyve](https://reviews.freebsd.org/D54087) and
[bhyvectl](https://reviews.freebsd.org/D54092) patches, so
can continue working on suspend/resume.

Spent some time on [SLIRP MTU configuration](https://reviews.freebsd.org/D54133)
and spotted an [issue](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=291616).

Updated the
[SLIRP patch for libvirt](https://lists.libvirt.org/archives/list/devel@lists.libvirt.org/thread/HYOSWHPAXHTXI4DVWM7ETTEFMVACLRXC/),
waiting for reviews.

#### **Completed Tasks**

 * `bhyve` side of things for continuing the suspend/resume work.

#### **Blockers**

Outline on the `bhyve` issues that are either blockers or create
a noticeable inconvenience for development:

 * [bootindex not working](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=279720)
 * [resume issues](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=290735)
 * [tpm issues](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=287326)
 * [virio-input not working](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=290364)

#### **Next Steps**

 * Addressing review comments on the already submitted patches and
   working on the new features (NUMA and virtio-scsi),
 * Additionally, I am looking into getting arm64 setup to add arm64
   support for the libvirt driver.

---

## **Reporting Period:** [2025-12-01] - [2025-12-07]

### Project: libvirt on FreeBSD
#### **Overall Status:** On Track
#### **Summary**

Posted a couple of patches for
[bhyve](https://reviews.freebsd.org/D54087) and
[bhyvectl](https://reviews.freebsd.org/D54092) to hopefully continue the
[discussion](https://lists.freebsd.org/archives/freebsd-virtualization/2025-November/003322.html)
on the suspend/resume interface.

I have rebased my patch for the bootindex support to test it
with other guests than Ubuntu Linux, but still hit the
[bug](https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=279720).
Might try it on `releng/14` as well to check whether it's a regression.

Also started looking into adding two more features to the libvirt's bhyve driver:

 * Guest NUMA domains configuration (`bhyve -n`),
 * Virtio-scsi device support.

#### **Completed Tasks**

 * Ports were updated to 11.10.0. That was also merged back to the 2025Q4
   due to the security issues this release addresses.

#### **Blockers**

Same as before.

#### **Next Steps**

 * Addressing review comments on the already submitted patches and
   working on the new features (NUMA and virtio-scsi). 
